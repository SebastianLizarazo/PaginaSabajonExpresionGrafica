<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda de Sabajones</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
  
    <header>
        <div class="logo">
            <img src="resources/logo.jpg" alt="Sabajones la tierrita">
        </div>
        <nav>
            <ul>
                <li><a href="#inicio">Inicio</a></li>
                <li><a href="#sabajones">Sabajones</a></li>
                <li><a href="#blog">Blog</a></li>
                <li><a href="#contacto">Contacto</a></li>
            </ul>
        </nav>
    </header>

    <section id="inicio" class="hero">
        <h2>Los mejores Sabajones de producción local</h2>
        <p>
            Los momentos se disfrutan mejor, con la auténtica tradición <br>
            Sabajones producidos en el municipio de Tibasosa <br>
            del el departamento de Boyacá hechos con los sabores<br>
            autóctonos de la región perfecta para compartir
        </p>
        <a href="#sabajones" class="cta">Ver Sabajones</a>
    </section>

    <section id="sabajones" class="productos">
        <h2>Nuestros Sabajones</h2>
        <div class="galeria">
            <div class="sabajon">
                <img src="resources/sabajonFeijoa.png" alt="Sabajon Feijoa">
                <h3>Don Joaquín Feijoa 750cc</h3>
                <p>$40.000</p>
            </div>
            <div class="sabajon">
                <img src="resources/sabajonCafe.png" alt="Sabajon Cafe">
                <h3>Don Joaquín Cafe 375cc</h3>
                <p>$25.000</p>
            </div>
            <div class="sabajon">
                <img src="resources/sabajonMelocoton.png" alt="Sabajon Melocoton">
                <h3>Don Joaquín Feijoa 750cc</h3>
                <p>$40.000</p>
            </div>
        </div>
    </section>

    <section id="blog">
        <h2>Historia del Sabajón</h2>
        <article>
            <h3>La bebida colombiana que proviene de un postre italiano</h3>
            <p>
                El Sabajón es una bebida alcohólica muy popular en Colombia, 
                especialmente en épocas festivas como navidad, 
                su composición es relativamente simple: azúcar, alcohol, canela, leche, leche condensada, 
                yemas de huevos y mayoritariamente aguardiente, aunque también se suele utilizar ron.
                <br>
                Por sus ingredientes y su aspecto, esta bebida es similar a los cócteles,
                ponches y postres que se suelen tomar en Argentina, Estados Unidos, España, 
                Francia, México, Uruguay y Venezuela, pero esto tiene un motivo, su origen.
                <br>
                El Sabajón colombiano, el Sabayón o Sambayón argentino, 
                el Rompope mexicano, el Sabajon francés, el Sabayon español y el ponche de crema 
                venezolano tienen su origen en el Zabaione o Zabaglione, un postre que fue inventado 
                en Italia a comienzos del siglo XVI.
                <br>
                Quien invento este postre es incierto, pues dependiendo de la zona se habla de una 
                persona u otra, por ejemplo, muchos hablan de Emiliano Giovanni Baglioni, 
                un capitán de navío, que sería alimentado con uvas, vino y huevos en los 
                puertos italianos, creando de forma casi mágica este postre; otra creencia 
                popular es la del fraile franciscano Pascual Baylón, debido a que en la literatura
                este postre era referenciado como “la crema di San Baylon”.
            </p>
        </article>
    </section>

    <section id="contacto" class="formulario">
        <h2>Contáctanos</h2>
        <form action="#" method="post">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" name="nombre" required>

            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>

            <label for="mensaje">Mensaje:</label>
            <textarea id="mensaje" name="mensaje" rows="5" required></textarea>

            <button type="submit">Enviar</button>
        </form>
    </section>
    <div id="paginaVenta" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <img id="modalImage" src="" alt="Detalle Sabajón">
            <h3 id="modalTitle"></h3>
            <p id="modalPrice"></p>
            <p id="modalDescription"></p>
    
            <!--  sección para seleccionar cantidad -->
            <div class="cantidadPro">
                <label for="quantity">Cantidad:</label>
                <input type="number" id="quantity" value="1" min="1" max="10">
                <p id="availableQuantity"></p> <!-- Cantidad disponible -->
            </div>
            <!-- Mostrar precio total antes de la compra -->
            <p id="totalPrice"></p>
            <!-- Botón para realizar la compra -->
            <button id="buyButton" class="buy">Comprar</button>
        </div>
    </div>
    
    <!-- pagina  de compra -->
    <div id="confirmacionCompra" class="modal">
        <div class="modal-content">
            <span class="closeConfirmation">&times;</span>
            <h3>¡Compra realizada con éxito!</h3>
            <p>Gracias por tu compra. El pedido será procesado pronto.</p>
        </div>
    </div>
    <script>
          let currentSabajonIndex = 0; 
        const sabajones = [
            {
                image: 'resources/sabajonFeijoa.png',
                title: 'Don Joaquín Feijoa 750cc',
                price: 40000,
                description: 'Sabajón de feijoa, producido localmente en Tibasosa, Boyacá.',
                stock: 5 // Cantidad disponible
            },
            {
                image: 'resources/sabajonCafe.png',
                title: 'Don Joaquín Cafe 375cc',
                price: 25000,
                description: 'Sabajón con sabor a café, ideal para acompañar postres y sobremesas.',
                stock: 8
            },
            {
                image: 'resources/sabajonMelocoton.png',
                title: 'Don Joaquín Melocotón 750cc',
                price: 40000,
                description: 'Delicioso sabajón de melocotón con una suave textura y gran sabor.',
                stock: 3
            }
        ];
    
        const modal = document.getElementById("paginaVenta");
        const modalImage = document.getElementById("modalImage");
        const modalTitle = document.getElementById("modalTitle");
        const modalPrice = document.getElementById("modalPrice");
        const modalDescription = document.getElementById("modalDescription");
        const totalPriceElement = document.getElementById("totalPrice");
        const quantityInput = document.getElementById("quantity");
        const availableQuantityElement = document.getElementById("availableQuantity");
        const buyButton = document.getElementById("buyButton");
        const confirmation = document.getElementById("confirmacionCompra");
        const closeConfirmation = document.getElementsByClassName("closeConfirmation")[0];
        const closeModal = document.getElementsByClassName("close")[0];
    
        let currentSabajonPrice = 0;
        let currentSabajonStock = 0; // Stock actual del sabajón
    
        // Abrir modal al hacer click en las imágenes
        document.querySelectorAll('.sabajon img').forEach((img, index) => {
    img.addEventListener('click', () => {
        const sabajon = sabajones[index];
        currentSabajonIndex = index; // Guardar el índice del producto actual
        modalImage.src = sabajon.image;
        modalTitle.textContent = sabajon.title;
        modalPrice.textContent = `$${sabajon.price}`;
        modalDescription.textContent = sabajon.description;
        modal.style.display = "flex";
        currentSabajonPrice = sabajon.price;
        currentSabajonStock = sabajon.stock; // Actualizar la cantidad disponible
        availableQuantityElement.textContent = `Disponibles: ${currentSabajonStock}`;
        quantityInput.max = currentSabajonStock; // Limitar la cantidad seleccionable al stock disponible
        totalPriceElement.textContent = ''; // Limpiar el precio total
        quantityInput.value = 1; // Restablecer la cantidad a 1
        updateTotalPrice(); // Mostrar el precio iniciall
            });
        });
    
        // Cerrar la pagina de compra
        closeModal.onclick = function() {
            modal.style.display = "none";
        };
    
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        };
    
        // Actualiza el precio  cada vez que cambie la cantidad
        quantityInput.addEventListener('input', updateTotalPrice);
    
        function updateTotalPrice() {
            const quantity = parseInt(quantityInput.value);
            const totalPrice = currentSabajonPrice * quantity;
            totalPriceElement.textContent = `Total a pagar: $${totalPrice}`;
        }
    
        // Mostrar la pagina de confirmación de compra
        buyButton.onclick = function() {
            const quantity = parseInt(quantityInput.value);
    
            if (quantity > currentSabajonStock) {
                alert('No hay suficientes productos disponibles.');
            } else {
                sabajones[currentSabajonIndex].stock -= quantity;
        currentSabajonStock -= quantity;

        // Actualizar la cantidad disponible 
        availableQuantityElement.textContent = `Disponibles: ${currentSabajonStock}`;
        quantityInput.max = currentSabajonStock; // Actualizar el máximo permitido para la cantidad seleccionable

        // Cerrar pagina de compra 
        modal.style.display = "none";

        // Mostrar pagina de confirmación de compra
        confirmacionCompra.style.display = "flex";

        // Si el stock llega a 0, mostrar un mensaje
        if (currentSabajonStock === 0) {
            alert('El producto se ha agotado.');
        }
            }
        };
    
        // Cerrar pagina  de confirmación
        closeConfirmation.onclick = function() {
            confirmation.style.display = "none";
        };
    
        window.onclick = function(event) {
            if (event.target == confirmacionCompra) {
                confirmation.style.display = "none";
            }
        };
    </script>